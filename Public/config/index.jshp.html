<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, height=device-height">
    <title>Server Config</title>
    <style>
        body {
            font-family: monospace;
            font-size: 105%;
        }
    </style>
</head>
<body>

    <h2 id="heading"></h2>

    <!-- normal browser script -->
    <script>
        const heading = 'Server Config';
        document.getElementById('heading').innerHTML = `${heading}`;
    </script>

    <?jshp
        if ($_GET['act'] && !Array.isArray($_GET['act']))
            switch ($_GET['act']) {
                case 'reconf': {
                    await Server.reloadConfig();
                    if (Number(await getStatusCode()) === 200) { ?>
                        <script>
                            location.href = `${location.origin}${location.pathname}`;
                        </script>
                    <?jshp }
                    break;
                }
                case 'recomp': {
                    await Server.recompile();
                    if (Number(await getStatusCode()) === 200) { ?>
                        <script>
                            location.href = `${location.origin}${location.pathname}`;
                        </script>
                    <?jshp }
                    break;
                }
                default: {
                    Message.echo('/config/ invalid act: ' + $_GET['act'], 'orange');
                    break;
                }
            }
        Message.echo(JSON.stringify($_CONFIG, null, 4));
    ?>
</body>
</html>
